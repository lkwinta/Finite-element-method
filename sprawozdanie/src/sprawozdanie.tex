\documentclass[a4paper]{article}

\usepackage{polski}
\usepackage[utf8]{inputenc}

\usepackage[export]{adjustbox}
\usepackage{scrextend}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{svg}

\usepackage{geometry}
\geometry{a4paper, left=15mm, top=30mm, right=15mm, bottom=20mm}

\usepackage{gensymb}
\usepackage{graphicx} 
\usepackage{isotope}
\usepackage{array}
\usepackage{float}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{multirow}

\usepackage{hyperref}
\usepackage{sectsty}
\usepackage{enumitem}
\usepackage{listings}
\usepackage[labelformat=simple]{subcaption}
\usepackage{xcolor,colortbl}
\usepackage{animate}

\sectionfont{\normalfont\huge\sectionrule{0pt}{0pt}{-6pt}{1pt}}
\subsectionfont{\normalfont\LARGE}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,LO]{\Large Łukasz Kwinta}
\fancyfoot[CE,CO]{\Large\thepage}

\renewcommand{\footrulewidth}{1pt}
\renewcommand{\headrulewidth}{1pt}

\definecolor{Gray}{gray}{0.85}
\definecolor{LightGray}{gray}{0.95}

\newcolumntype{a}{>{\columncolor{Gray}}c}
\newcolumntype{b}{>{\columncolor{white}}c}

\Large
\begin{document}
\section{Wyprowadzenie sformułowania słabego}
Założenia:
\[-\frac{d}{dx}\left(k(x)\frac{du(x)}{dx}\right) = 100x \]
\[u(2) = 0\]
\[\frac{du(0)}{dx} + u(0) = 20\]
\[k(x) =
 \begin{cases}
    1  & \text{dla} x\in [0,1]\\
    2x & \text{dla} x\in (1,2]
  \end{cases}\]
  \[u: [0,2] \ni x \mapsto u(x) \in \mathbb{R}  \]

  Wyprowadzenie sformułowania słabego zaczynam od obustronnego całkowania równania 
  razem z przemnożeniem go przez funkcję testującą $\phi$:
  \[-\int_{0}^{2}(ku')'\phi dx = \int_{0}^{2}100x\phi dx\]

  Całkując lewą stronę przez części można ją uprościć:
  \[-\int_{0}^{2}(ku')'\phi dx = -\left[ku'\phi\right]_0^2 + \int_{0}^{2}ku'\phi' dx
  = -k(2)u'(2)\phi(2) + k(0)u'(0)\phi(0) + \int_{0}^{2}ku'\phi' dx = ...\]

  Korzystając z warunku Dirichleta na prawym brzegu, wiemy że $\phi(2) = 0$ co zeruje jeden człon brzegowy:
  \[... = k(0)u'(0)\phi(0) + \int_{0}^{2}ku'\phi' dx = ... \]

  Następnie korzystając z warunku Cauchego na lewym brzegu upraszczam drugi człon brzegowy:
  \[u'(0) = 20 - u(0)\]
  \[... = k(0)(20 - u(0))\phi(0) + \int_{0}^{2}ku'\phi' dx = 20k(0)\phi(0) - k(0)u(0)\phi(0) + \int_{0}^{2}ku'\phi' dx = ...\]

  Na koniec pozostało podstawić funkcję $k(x)$:
  \[... = 20\phi(0) - u(0)\phi(0) + \int_{0}^{1}u'\phi' dx + \int_{1}^{2}2xu'\phi' dx\]

  Wracając do początkowego równania przenoszę człony niezależące od $u$, na prawą stronę:
  \[20\phi(0) - u(0)\phi(0) + \int_{0}^{1}u'\phi' dx + \int_{1}^{2}2xu'\phi' dx = \int_{0}^{2}100x\phi dx\]
  \[-u(0)\phi(0) + \int_{0}^{1}u'\phi' dx + \int_{1}^{2}2xu'\phi' dx = \int_{0}^{2}100x\phi -20\phi(0)dx\]

  Niech:
  \[B(u, \phi) = -u(0)\phi(0) + \int_{0}^{1}u'\phi' dx + \int_{1}^{2}2xu'\phi' dx\]
  \[L(\phi) = \int_{0}^{2}100x\phi -20\phi(0)dx\]

  Teraz mogę zapisać sformułowanie słabe (wariacyjne). Niech
  \[ V := \left\{f \in H^1 : f(2) = 0\right\} \]
  \[\text{Szukamy:} \quad u \in V \quad \text{takiego, że:} \quad B(u, \phi) = L(\phi) \qquad \forall \phi \in V \]
  \pagebreak
  \section{Dyskretyzacja problemu}
  Jako, że $\dim V = \inf$ nie możemy rozwiązać takiego równania. Dlatego wybieramy podprzestrzeń liniową
  $V_h \subset V$
  \[V_h = span \left\{e_0, e_1, e_2, ... , e_n\right\}\]
  Gdzie funkcje z bazy podprzestrzeni są funkcjami generowanymi przez wzór:
  \[
    e_i = 
    \begin{cases}
        \frac{x - x_{i-1}}{x_i - x_{i-1}}  & \text{dla} \quad x\in [0,1]\\
        \frac{x_{i+1} - x}{x_{i+1} - x_i}  & \text{dla} \quad x\in (1,2] \\
        0 & \text{w przeciwnym wypadku}
    \end{cases}  
  \]
  \pagebreak
\end{document}